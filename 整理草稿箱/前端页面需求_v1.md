# 前端页面需求 v1（管理台原型）

> 目标：提供“运行/列表/得分”三页，覆盖最小闭环的提交、观测与回放；后续扩展到治理与配置。

## 1. 运行页（/run）
- 表单项：
  - SRS 文件路径/上传或文本框（必填）
  - 数据 CSV 路径（必填）
  - 输出路径（默认 reports/weekly_report.md）
  - 角色实现选择（planner/executor/critic/reviser，下拉）
  - LLM 参数（温度、重试、max_rows）
  - 预算/超时（可选）
- 行为：提交后触发后台 run，返回 trace_id 与结果摘要；链接到详情

## 2. 列表页（/episodes）
- 数据源：SQLite Outbox（config.outbox.sqlite_path）
- 列表字段：trace_id、状态、模型、提供商、得分、通过、延迟、创建时间
- 操作：查看事件（展开/详情页）、回放（review-only）、复跑（本地技能）

## 3. 得分页（/scores）
- 数据源：scores.sqlite（若无则提示先导出）
- 汇总：总数、平均分、通过率、平均延迟、P50/P95 延迟
- 分组：按模型/提供商汇总（count/avg_score/pass_rate）
- TopN：topN 明细表
- 导出：CSV（分组/明细）、HTML 下载

## 4. 技术与约束
- 技术：FastAPI + Jinja2（SSR），轻交互可用 htmx/Alpine.js
- 权限：本地内网使用，后续接入 OIDC
- 安全：不展示敏感信息（脱敏）；仅允许读取指定目录；复跑仅走本地技能

## 5. API 约定（v1）
- GET /api/episodes?limit=50
- GET /api/episodes/{trace_id}
- POST /api/run（body: srs_path, data_path, out, planner/executor/critic/reviser）
- GET /api/scores?group_by=model&since=...&until=...&topN=10

## 6. 后续扩展
- 配置编辑（config.json 可视化）
- 治理：审批流、预算阈值、敏感操作告警
- Router 可视：多提供商路由权重与失败率曲线
