<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Superflow - 工作流编辑器</title>
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
      }
      h1 {
        color: #333;
        margin-bottom: 30px;
      }
      .section {
        margin-bottom: 30px;
        padding: 20px;
        border: 1px solid #eee;
        border-radius: 6px;
      }
      .section h2 {
        color: #555;
        margin-top: 0;
      }
      workflow-flow {
        display: block;
        width: 100%;
        height: 600px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin: 10px 0;
      }
      workflow-node {
        display: block;
        width: 100%;
        min-height: 400px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin: 10px 0;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Superflow 工作流编辑器</h1>

      <div class="section">
        <h2>流程画布</h2>
        <workflow-flow id="canvas"></workflow-flow>
      </div>

      <div class="section">
        <h2>节点页面</h2>
        <workflow-node id="page"></workflow-node>
      </div>
    </div>

    <script type="module">
      // 导入Web组件
      import './src/flow/FlowCanvas.ts';
      import './src/nodes/NodePage.ts';

      // 初始化画布 - 创建一个更复杂的工作流示例
      const canvas = document.getElementById('canvas');
      if (canvas) {
        canvas.blueprint = {
          requirement: '数据处理工作流示例',
          steps: [
            {
              id: 'start',
              label: '开始',
              type: 'input',
              description: '工作流开始节点',
              inputs: [],
              outputs: ['data'],
              next: ['collect'],
            },
            {
              id: 'collect',
              label: '数据收集',
              type: 'process',
              description: '收集输入数据',
              inputs: ['data'],
              outputs: ['raw_data'],
              next: ['process'],
            },
            {
              id: 'process',
              label: '数据处理',
              type: 'process',
              description: '处理和清洗数据',
              inputs: ['raw_data'],
              outputs: ['processed_data'],
              next: ['validate', 'analyze'],
            },
            {
              id: 'validate',
              label: '验证数据',
              type: 'validation',
              description: '验证数据完整性',
              inputs: ['processed_data'],
              outputs: ['validated_data'],
              next: ['report'],
            },
            {
              id: 'analyze',
              label: '分析数据',
              type: 'analysis',
              description: '分析数据趋势',
              inputs: ['processed_data'],
              outputs: ['analysis_result'],
              next: ['report'],
            },
            {
              id: 'report',
              label: '生成报告',
              type: 'output',
              description: '生成分析报告',
              inputs: ['validated_data', 'analysis_result'],
              outputs: ['report'],
              next: ['notify'],
            },
            {
              id: 'notify',
              label: '发送通知',
              type: 'notification',
              description: '发送完成通知',
              inputs: ['report'],
              outputs: ['notification'],
              next: ['end'],
            },
            {
              id: 'end',
              label: '结束',
              type: 'output',
              description: '工作流结束',
              inputs: ['notification'],
              outputs: [],
              next: [],
            },
          ],
        };
      }

      // 监听事件
      const page = document.getElementById('page');
      if (page) {
        page.addEventListener('flow-import', (e) => {
          console.log('Flow imported:', e.detail);
        });

        page.addEventListener('run', (e) => {
          console.log('Node run:', e.detail);
        });
      }
    </script>
  </body>
</html>
